<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>HW3</title>
    <script src="https://d3js.org/d3.v3.min.js"></script>
</head>

<body>
   <h1>第一題</h1>
    <input type="button" value="新增" onclick="update()">
    <input type="button" value="移除" onclick="my_delete()">
    <script>
        var arr = [85, 60, 99, 49, 77, 82];
        var w = 600;
        var h = 400;
        var p = 100;

        svg1();
        bind1(arr);
        render1();

        function svg1() {
            d3.select("body")
                .append("svg")
                .attr({
                    "width": w,
                    "height": h
                })
        }


        function bind1(data) {
            //長方形狀態一
            var selection = d3.select("svg")
                .selectAll("rect")
                .data(data);

            //狀態二        
            selection.enter()
                .append("rect")

            //狀態三
            selection.exit()
                .remove();

            //文字狀態一
            var selection_text = d3.select("svg")
                .selectAll("text")
                .data(data);

            selection_text.enter()
                .append("text");

            selection_text.exit()
                .remove();
        }


        //render
        function render1() {
            d3.selectAll("rect")
                .attr({
                    "x": function(d, i) {
                        return p + 43 * i;
                    },
                    "y": function(d) {
                        return h - p - d;
                    },
                    "width": 40,
                    "height": function(d) {
                        return d;
                    },
                    "fill": function(d) {
                        if (d < 70) {
                            return "red";
                        } else {
                            return "lightgreen";
                        }
                    }
                });
            d3.selectAll("text")
                .attr({
                    "x": function(d, i) {
                        return p + 43 * i + 10;
                    },
                    "y": function(d) {
                        return h - p + 25;
                    }
                }).text(function(d) {
                    return d;
                });

        }

        function update() {
            var num = random(10, 100);
            arr.push(num);
            bind1(arr);
            render1();
        }

        function my_delete() {
            arr.shift();
            bind1(arr);
            render1();
        }

        function random(N, M) {
            var rScale = d3.scale.linear()
                .domain([0, 1])
                .rangeRound([N, M]);
            return rScale(Math.random());
        }
    </script>
    <br>
    <hr>
    <h1>第二題連結</h1>
    <p>在console.log測試</p>
    <span>
        <a href="https://summerwill.github.io/hw03/hw03/hw03-2">第二題</a>
    </span>
    <br>
    <hr>
    <h1>第三題</h1>
    <span>
        <a href="https://summerwill.github.io/hw03/hw03/hw03-3">第三題</a>
    </span>
    <br>
    <hr>
    <h1>第四題</h1>
    <span><a href="https://summerwill.github.io/hw03/hw03/hw03-4">第四題</a></span>
    <br>
    <hr>
    <h1>第五題</h1>
    <span><a href="https://summerwill.github.io/hw03/hw03/hw03-5">第五題</a></span>
    <br>
    <hr>
    
    
</body>
</html>